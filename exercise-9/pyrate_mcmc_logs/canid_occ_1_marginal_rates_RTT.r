# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.167016479906, 0.167016479906,0.167016479906,0.167016479906,0.129641987603,0.0660893762906,0.0418312488974,0.0516312644025,0.0516312644025,0.0516312644025,0.0516312644025,0.0516312644025,0.0516312644025,0.0516312644025,0.0516312644025,0.0512025298861,0.0418312488974,0.0512025298861,0.0539602035271,0.0718206644899,0.0899126832298,0.0890240356905,0.0890240356905,0.0899126832298,0.0899126832298,0.0899126832298,0.0899126832298,0.0899126832298,0.0904760903284,0.0847215259721,0.0899126832298,0.135647108228,0.151956500454,0.153165146012,0.151956500454,0.164105705368,0.153165146012,0.151956500454,0.151956500454,0.134838654618,0.151956500454,0.151956500454,0.151956500454,0.135647108228,0.151956500454,0.151956500454,0.10553581097,0.10553581097)
L_hpd_M95=c(0.354922413142, 0.354922413142,0.354922413142,0.354922413142,0.34201187211,0.31707883131,0.193874412702,0.137517918075,0.136437207073,0.136437207073,0.136760438452,0.136760438452,0.136760438452,0.136760438452,0.136760438452,0.136760438452,0.143514982214,0.15665016453,0.167358302105,0.205057776198,0.205057776198,0.203328241803,0.203328241803,0.203328241803,0.203328241803,0.203328241803,0.203328241803,0.203328241803,0.205057776198,0.21548596731,0.391445219788,0.435257844071,0.435257844071,0.435257844071,0.435257844071,0.448789906024,0.440708220119,0.440708220119,0.440708220119,0.419650666639,0.42748160132,0.42748160132,0.435071354594,0.419650666639,0.455175372966,0.465652084255,0.476047046809,0.482826267186)
M_hpd_m95=c(0.879744061131, 0.879744061131,0.0933724141766,0.0933724141766,0.0945631256074,0.0933724141766,0.0945631256074,0.0908977184001,0.0908977184001,0.0908977184001,0.0908977184001,0.0908977184001,0.0908977184001,0.0908977184001,0.0847906446143,0.0847906446143,0.0847906446143,0.0847906446143,0.0847906446143,0.0858738278462,0.0775213469028,0.0775213469028,0.051416320746,0.0450131660293,0.0391670356984,0.038770949532,0.0370515952241,0.0372234797258,0.0372234797258,0.0330036115906,0.0372234797258,0.0342426774865,0.0342426774865,0.0391670356984,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241,0.0370515952241)
M_hpd_M95=c(1.5009083052, 1.5009083052,0.175302316921,0.175302316921,0.175302316921,0.166798482988,0.154171337088,0.148462603695,0.148462603695,0.148462603695,0.145118481955,0.146140786633,0.146140786633,0.147086879111,0.142138136686,0.142138136686,0.142138136686,0.142138136686,0.142138136686,0.147086879111,0.194520015848,0.194520015848,0.18082784384,0.142138136686,0.135493247098,0.126977380519,0.117480148046,0.116109149727,0.116109149727,0.111270543191,0.117185631098,0.117185631098,0.117185631098,0.122119688846,0.127028105422,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647,0.132396945647)
R_hpd_m95=c(-1.2031950972, -1.2031950972,0.0149484381828,0.0149484381828,-0.00417636619813,-0.058684822874,-0.0906664878387,-0.0785897425816,-0.0748564806904,-0.0755363926703,-0.0762892823643,-0.0762892823643,-0.0762892823643,-0.0785897425816,-0.0762892823643,-0.0755363926703,-0.0696340186182,-0.0694060929102,-0.0694060929102,-0.0555884830499,-0.0524506030982,-0.0524506030982,-0.0524506030982,-0.0287695931113,-0.0172173514254,-0.0154937966965,-0.0154937966965,-0.0154937966965,-0.0154937966965,-0.0154937966965,0.00721504790087,0.0595148668669,0.0726944202896,0.0726944202896,0.0663466607973,0.0764174629659,0.0726944202896,0.0605885827534,0.0605885827534,0.0663466607973,0.0726944202896,0.0726944202896,0.0605885827534,0.0605885827534,0.0519331567653,0.0243840964693,-0.00571631509248,-0.00571631509248)
R_hpd_M95=c(-0.568633587598, -0.568633587598,0.20802975408,0.20802975408,0.215952454047,0.20802975408,0.108654147919,0.022471273288,0.022471273288,0.022471273288,0.022471273288,0.022471273288,0.022471273288,0.022471273288,0.0310061788626,0.0310061788626,0.0410190121022,0.0410190121022,0.0502084404752,0.0892293209815,0.0875514342203,0.0951054161981,0.108534123161,0.142598246864,0.149715771569,0.135380020883,0.135380020883,0.135380020883,0.13830394588,0.155425505282,0.333957248136,0.351901031803,0.345670691198,0.35090588955,0.351901031803,0.365651958988,0.36999514473,0.36999514473,0.36999514473,0.36999514473,0.36999514473,0.36999514473,0.36999514473,0.36999514473,0.36999514473,0.350859632765,0.405698808271,0.405698808271)
L_mean=c(0.259219864455, 0.259219864455,0.259219864455,0.259219864455,0.253313788333,0.215576141333,0.101792267736,0.093962781805,0.0935487957083,0.0936187837623,0.0934346907012,0.0936230273943,0.0944420541907,0.094164623432,0.0943540889463,0.0955439162198,0.0983602150885,0.104221657469,0.109558728316,0.12713377022,0.137851381206,0.138726835125,0.139266590062,0.139411157123,0.139411157123,0.139422950857,0.139422950857,0.139422950857,0.140293136562,0.143818607384,0.228285969102,0.278315323616,0.286192963243,0.288814392364,0.294480582732,0.295740635293,0.293835502035,0.293908048158,0.293808922509,0.291478818082,0.289734227782,0.289734227782,0.286464316754,0.287935053456,0.289035886165,0.291729230292,0.302698341511,0.303368318113)
M_mean=c(1.12336268475, 1.12336268475,0.126186047812,0.126186047812,0.125940826641,0.125494950415,0.121884186431,0.119530664844,0.118990532071,0.118921541267,0.118057932661,0.117788948324,0.117788948324,0.117428266155,0.11630785644,0.11630785644,0.11630785644,0.11630785644,0.116168556356,0.117210945547,0.12408363185,0.123739700858,0.120125311038,0.101741485101,0.0889258198909,0.0802267618734,0.0755065799746,0.0745147264177,0.0741154969454,0.0738205427507,0.0747351144204,0.0756253583155,0.0757520109089,0.0778656464473,0.0782711643899,0.0791032008088,0.0790607329913,0.0789970240105,0.0789419401462,0.0789419401462,0.0789419401462,0.0789419401462,0.0789419401462,0.0789419401462,0.0789419401462,0.0789419401462,0.0789419401462,0.0789419401462)
R_mean=c(-0.864142820297, -0.864142820297,0.133033816643,0.133033816643,0.127372961692,0.0900811909182,-0.0200919186951,-0.0255678830388,-0.0254417363626,-0.0253027575044,-0.0246232419598,-0.0241659209295,-0.0233468941331,-0.023263642723,-0.0219537674937,-0.0207639402202,-0.0179476413515,-0.0120861989709,-0.00660982803979,0.0099228246737,0.0137677493554,0.0149871342665,0.0191412790238,0.0376696720216,0.0504853372318,0.0591961889834,0.0639163708822,0.0649082244391,0.0661776396162,0.0699980646329,0.153550854682,0.2026899653,0.210440952334,0.210948745916,0.216209418342,0.216637434484,0.214774769044,0.214911024147,0.214866982363,0.212536877936,0.210792287636,0.210792287636,0.207522376608,0.208993113309,0.210093946019,0.212787290146,0.223756401365,0.224426377967)
trans=0.5
age=(0:(48-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.531108893904), xlim = c(-50.4,2.4), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.65099913572), xlim = c(-50.4,2.4), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.32351460692, 0.446268689098), xlim = c(-50.4,2.4), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-50.4,2.4), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()