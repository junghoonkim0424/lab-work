# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.127352346246, 0.127352346246,0.127352346246,0.127352346246,0.0972462216934,0.0643116930522,0.0401307133813,0.0406758458532,0.0406758458532,0.0430354359897,0.0431236335976,0.0430354359897,0.0430354359897,0.043382253795,0.043382253795,0.0434830903893,0.0495101892476,0.0537037437319,0.0558360808942,0.0572934651074,0.0752042970658,0.0842967308431,0.0856106905957,0.0855160697072,0.0856106905957,0.0855160697072,0.0850655104055,0.0777696693447,0.0806516682382,0.0784644246192,0.0870808000781,0.136684657549,0.150071266253,0.149551217634,0.149002847518,0.150461942524,0.151442570529,0.149551217634,0.145835003862,0.138058478425,0.138058478425,0.130907773834,0.130283064044,0.12521906426,0.121181296803,0.103090785266,0.0949166004809,0.0688227680023,0.0665862788133,0.0775948928395,0.0708010616352,0.0708010616352)
L_hpd_M95=c(0.345491806933, 0.345491806933,0.345296082916,0.345491806933,0.346152473258,0.335070744194,0.265804833199,0.135653530333,0.130907773834,0.131940498088,0.13152937182,0.130907773834,0.130428082721,0.130907773834,0.132222868082,0.135185633241,0.147050468415,0.156421601977,0.163731608546,0.176313424351,0.202471287971,0.203121001708,0.201947404003,0.201519780397,0.201947404003,0.201680507524,0.203121001708,0.204255585686,0.20914432002,0.318525215942,0.403208377696,0.46010587462,0.463905923994,0.46230561124,0.460573948367,0.46010587462,0.45939513601,0.458664168033,0.46010587462,0.455336968261,0.45849105689,0.46010587462,0.468187828949,0.468187828949,0.470020712547,0.460743153278,0.475593942151,0.478160572749,0.484550472412,0.499598943433,0.493653383481,0.493653383481)
M_hpd_m95=c(0.900407635089, 0.900407635089,0.0867261839849,0.0867261839849,0.0867261839849,0.0867261839849,0.0870524111667,0.0869045023328,0.0870524111667,0.0867261839849,0.0853824995537,0.0853824995537,0.0867261839849,0.0848039423936,0.0853824995537,0.0853824995537,0.0853824995537,0.0853824995537,0.0853824995537,0.0853824995537,0.0853824995537,0.0853165673394,0.0853824995537,0.0834240506739,0.0834240506739,0.073828739091,0.0571756971327,0.0523139368498,0.0496895709747,0.0496895709747,0.0496895709747,0.0497108546705,0.0485295203857,0.0431167530752,0.0372511950267,0.0282075325389,0.0216088090999,0.0210241239733,0.0216088090999,0.0206902146302,0.0203992535725,0.0158990709476,0.0138170423427,0.0216088090999,0.0206902146302,0.0203992535725,0.0203992535725,0.0203992535725,0.0203992535725,0.0203992535725,0.0203992535725,0.0203992535725)
M_hpd_M95=c(1.55090487674, 1.55090487674,0.141983402373,0.141983402373,0.141983402373,0.141937671803,0.141983402373,0.14086617719,0.140768909609,0.139553751527,0.135647981915,0.134327774441,0.134563370806,0.131652663842,0.130797746086,0.130601839165,0.130601839165,0.130601839165,0.130601839165,0.130601839165,0.130601839165,0.130431937654,0.130601839165,0.129430656857,0.130268312595,0.133117939781,0.127770313988,0.126810226667,0.124998565142,0.125571657539,0.125157554202,0.126284898287,0.126810226667,0.125325110863,0.128195170101,0.129420886844,0.125193909991,0.126810226667,0.131707404531,0.131707404531,0.132468495148,0.131707404531,0.132468495148,0.143283528132,0.143283528132,0.143283528132,0.143283528132,0.143283528132,0.143283528132,0.143283528132,0.143283528132,0.143283528132)
R_hpd_m95=c(-1.28639511437, -1.28639511437,0.0275378347309,0.0271895706402,-0.0127189783918,-0.0503068472894,-0.0743927144428,-0.0776228226332,-0.0734409822897,-0.0734409822897,-0.0734409822897,-0.0680378977365,-0.0680378977365,-0.0668338444238,-0.0655129890969,-0.0659304807085,-0.0627182471154,-0.0631025709431,-0.0627182471154,-0.053893981268,-0.0403606698772,-0.0304315387295,-0.0284231871315,-0.0284231871315,-0.0284231871315,-0.029852813977,-0.0331849057656,-0.0324783084117,-0.0356586081464,-0.040536456511,-0.0185588295729,0.0381752469242,0.0505826482687,0.04267319262,0.0474423645176,0.0539225949893,0.0591875979541,0.0560114009478,0.0407702491611,0.0359497088248,0.0239687421339,0.0247600072816,0.0239687421339,0.0138273568537,0.00960758163689,-0.000519026581618,-0.000662592264517,-0.0557605081472,-0.0520781287151,-0.0557605081472,-0.0557605081472,-0.0557605081472)
R_hpd_M95=c(-0.611670084626, -0.611670084626,0.248710882685,0.248710882685,0.244882788923,0.224446792382,0.165018031366,0.0317323161137,0.0294565829041,0.0276775736237,0.0267362419012,0.0317323161137,0.0317323161137,0.0305962726041,0.0305333337149,0.0322502075617,0.0430852814756,0.0497431077491,0.0563638955104,0.0746186122047,0.092365050697,0.101795867191,0.101433936146,0.101199780584,0.101376590583,0.101999558715,0.108531651001,0.124494837124,0.124494837124,0.215568827542,0.32111539235,0.372371474489,0.37946070008,0.373265793709,0.378943356788,0.38604866456,0.38604866456,0.38604866456,0.378943356788,0.378943356788,0.375940405218,0.38604866456,0.38973924294,0.38604866456,0.38604866456,0.386083156983,0.411780319179,0.395477626705,0.408063336866,0.407425673574,0.407425673574,0.407425673574)
L_mean=c(0.267489518468, 0.267489518468,0.267443870516,0.267211378434,0.25636555542,0.220060906265,0.109275083097,0.0875788696312,0.086228562515,0.0859026809994,0.08618904736,0.0864963389937,0.0866540048055,0.0868038107128,0.0877137419774,0.0893148915984,0.0950985797284,0.101322310325,0.105552476782,0.114121548629,0.128497578314,0.13415048044,0.135158205462,0.135499758139,0.135322717011,0.134932553659,0.132345153014,0.129910978546,0.130265264709,0.146906048441,0.232083948857,0.318166034533,0.322547563897,0.322975648465,0.322638488081,0.320553377413,0.317550433929,0.315794269247,0.313579299534,0.310666638054,0.309638427191,0.306968581847,0.304533913925,0.301330426602,0.298865100253,0.2960967355,0.294235830125,0.286978156867,0.285596803003,0.285746367798,0.285639051673,0.285576383922)
M_mean=c(1.20144614224, 1.20144614224,0.111810171081,0.111804796217,0.111809581345,0.111656734539,0.11152724394,0.111282099739,0.111184172252,0.110719597096,0.109889247368,0.109433491573,0.109186009801,0.108460606376,0.10771050941,0.107294372404,0.107077431067,0.106836322997,0.106784261598,0.106791780583,0.106791780583,0.106777022877,0.106737079948,0.106538280513,0.106242041809,0.103619956339,0.10004711329,0.0972107837035,0.0957300319481,0.0950439941446,0.0955648255617,0.0949585842362,0.0944090527709,0.0938916936201,0.0906041243641,0.087846558876,0.0869794141113,0.0872476431335,0.0881144864185,0.0882634870169,0.0884127625095,0.0885289853284,0.089128644284,0.0899484876105,0.0902465993506,0.0904378155022,0.0904684205698,0.0904684205698,0.0904684205698,0.0904684205698,0.0904684205698,0.0904684205698)
R_mean=c(-0.933956623774, -0.933956623774,0.155633699435,0.155406582217,0.144555974075,0.108404171725,-0.00225216084312,-0.0237032301081,-0.0249556097373,-0.0248169160961,-0.0237002000083,-0.0229371525791,-0.022532004995,-0.0216567956633,-0.0199967674322,-0.0179794808051,-0.0119788513386,-0.00551401267236,-0.001231784816,0.00732976804662,0.0217057977314,0.0273734575636,0.0284211255135,0.0289614776262,0.0290806752016,0.0313125973193,0.0322980397241,0.0327001948426,0.0345352327608,0.0518620542965,0.136519123295,0.223207450297,0.228138511127,0.229083954844,0.232034363717,0.232706818538,0.230571019818,0.228546626113,0.225464813116,0.222403151037,0.221225664681,0.218439596519,0.215405269641,0.211381938991,0.208618500903,0.205658919998,0.203767409555,0.196509736297,0.195128382433,0.195277947228,0.195170631103,0.195107963352)
trans=0.5
age=(0:(52-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.549558837776), xlim = c(-54.6,2.6), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.70599536441), xlim = c(-54.6,2.6), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.4150346258, 0.452958351097), xlim = c(-54.6,2.6), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-54.6,2.6), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()